---
layout: single
title: 배치 시스템 통합 방안 검토 및 SCDF 도입
categories: SCDF
tag: [SCDF]
toc: true
#author_profile: false
#sidebar:
#    nav: "docs"
---

> 팀 블로그용 원고

## 📌 배경

신규 프로젝트를 진행하면서 기존 시스템들과의 배치 작업 연계가 필요한 과제가 주어졌습니다.
장기적인 유지보수를 고려하여 기존 배치 작업을 검토한 결과, 다음과 같은 문제점이 발견되었습니다.

### 🔹 기존 배치 작업의 문제점
- **모니터링 불가**: 배치 작업의 상태(실행, 완료, 실패)를 실시간으로 파악할 수 없음.
- **모놀리식 구조**: 하나의 배치 작업에 모든 로직이 포함되어 있어 유지보수와 확장이 어려움.
- **확장성 부족**: 새로운 요구사항이 추가될 경우 기존 구조로는 유연하게 대처하기 어려움.

이에 따라 지속 관리가 가능하고 확장성을 고려한 통합 방안을 모색할 필요성이 제기되었습니다.
이를 해결하기 위해 여러 기술을 검토하기로 결정하였습니다.

---

## 📌 요구사항 정리

새로운 통합 배치 시스템 설계를 위해 다음과 같은 요구사항을 정의하였습니다.

### ✅ 주요 요구사항
1) **배치성 작업 처리**
    - 주기적으로 실행되거나 특정 조건에서 실행되는 배치 작업을 지원해야 함.

2) **모니터링 가능성**
    - 배치 작업의 실행 상태(실행 중, 완료, 실패) 및 상세 로그를 실시간으로 모니터링 가능해야 함.

3) **확장 가능성**
    - 새로운 배치 작업이 추가될 때 기존 구조를 변경하지 않고 유연하게 확장할 수 있어야 함.

4) **통합 관리**
    - 다양한 배치 작업을 하나의 플랫폼에서 관리하고, 작업 순서를 명확히 정의할 수 있어야 함.

---

## 📌 기능 정의

요구사항을 충족하기 위해 배치 작업을 **세 가지 유형**으로 분류하여 관리하도록 정의하였습니다.

### 🔹 1) 워크플로 기반

#### 📝 정의
- 여러 개의 작업(Task) 간의 실행 순서를 정의하고, 의존성을 관리하며 단계적으로 실행하는 방식.

#### ⚡ 특징
- 정기적인 스케줄 또는 이벤트 트리거를 통한 실행 지원.
- 실패 시 특정 단계부터 재실행 가능하여 유연한 오류 복구 가능.

#### 💡 적용 사례
- 데이터 처리 파이프라인 (ETL, 머신러닝 파이프라인 등).

---

### 🔹 2) 배치 기반

#### 📝 정의
- 데이터를 특정 시간에 일괄적으로 모아 처리하는 방식.

#### ⚡ 특징
- 정기적 실행 (크론잡 등) 을 통해 주기적으로 데이터 처리.
- 대량 데이터 처리에 적합하며, 데이터가 누적된 후 실행됨.
- 작업 간 의존성이 단순한 경우에 적합.

#### 💡 적용 사례
- 데이터 백업 (예: 매일 밤 12시 백업 수행).
- 정기 보고서 생성 (예: 매월 1일 재무 보고서 자동 생성).
- 로그 데이터 집계 (예: 서버 로그를 모아서 분석용 데이터로 변환).

---

### 🔹 3) 스트리밍 기반

#### 📝 정의
- 데이터가 발생하는 즉시 실시간으로 처리하는 방식.

#### ⚡ 특징
- 이벤트 기반으로 작업 처리하여 낮은 지연 시간 제공.
- Kafka, RabbitMQ 등의 메시지 브로커와 통합 가능.
- 빠른 데이터 처리 성능이 요구되는 환경에서 효과적.

#### 💡 적용 사례
- 실시간 로그 분석 (예: 애플리케이션 오류 로그를 즉시 감지하고 알림).
- IoT 데이터 처리 (예: 센서 데이터가 들어오면 즉시 저장 및 분석).
- 이벤트 기반 데이터 처리 (예: 사용자의 특정 행동이 발생하면 바로 데이터 반영).

---

## 📌 기술 탐색

요구사항과 기능 정의를 바탕으로 **Apache Airflow**와 **Spring Cloud Data Flow (SCDF)** 두 가지 기술을 중점적으로 검토하였습니다.

---

### 🔹 1) Apache Airflow (워크플로 기반)

#### ⚡ 특징
- DAG(Directed Acyclic Graph) 기반으로 복잡한 작업 간 의존성 관리 가능.
- 내장 스케줄러를 통해 정기적인 배치 작업 실행.
- UI를 통해 작업 상태(성공, 실패, 실행 중)를 실시간으로 확인 가능.
- Python 기반으로 코드 작성 가능.

#### 💡 적합한 사례
- 복잡한 ETL 파이프라인 설계.
- 머신러닝 모델 학습 및 평가 파이프라인 관리.

---

### 🔹 2) Spring Cloud Data Flow (SCDF, 배치 및 스트리밍 통합)

#### ⚡ 특징
- 배치(Spring Batch)와 스트리밍(Spring Cloud Stream)을 통합 관리.
- Kafka, RabbitMQ와 같은 메시지 브로커를 통해 실시간 데이터 흐름 처리.
- Prometheus/Grafana 연동을 통해 모니터링 가능.
- Java 기반으로 Spring 생태계를 활용하여 개발 가능.

#### 💡 적합한 사례
- 실시간 로그 처리.
- 이벤트 기반 데이터 분석 및 처리.
- 대규모 배치 데이터 변환.

---

### 🔹 3) Spring Batch + Jenkins + Spring Batch Admin (제외)

#### ⚡ 특징
- 최근 **Spring 진영에서는 Spring Batch 작업의 관리 도구로 Jenkins를 사용하는 것을 권장하지 않는 추세**입니다.  
  대신, Spring Cloud Data Flow (SCDF)를 활용한 배치 작업 관리를 추천하고 있습니다.  
  이는 SCDF가 **배치 및 스트리밍 작업의 통합 관리, 확장성, 모니터링 기능 등에서 더 우수한 기능**을 제공하기 때문입니다.

- 특히, **이전에 사용되던 Spring Batch Admin은 현재 Deprecated 상태**로, 더 이상 유지보수가 진행되지 않으며,  
  **Spring 공식 문서에서도 SCDF로의 전환을 권장**하고 있습니다.

#### 📌 참고 자료
- Spring Batch Admin 공식 문서 (Deprecated)  
  [📎 Spring Batch Admin Documentation](https://docs.spring.io/spring-batch-admin/2.x/)

---

## 📌 기술 선택의 이유

최종적으로 **Spring Cloud Data Flow (SCDF)** 를 도입하기로 결정하였습니다.

### 🔹 SCDF 선택 이유
✅ Java 기반 기술 스택과의 호환성  
✅ 단계별 배포 및 확장성 보장  
✅ Nexus 기반의 Java 애플리케이션 관리  
✅ Kafka 및 RabbitMQ를 활용한 실시간 데이터 처리  
✅ Prometheus/Grafana를 통한 모니터링 지원

---

## 📌 향후 계획: PoC(개념 증명) 진행

SCDF의 도입 가능성을 검증하기 위해 **PoC(Proof of Concept)** 를 진행하기로 결정하였습니다.

### ✔ PoC 검증 항목
1) **배치 기능 구현**
    - 특정 폴더에 저장된 CSV 파일을 읽고 데이터베이스에 저장하는 배치 작업 수행 검증.

2) **배치 작업 실행 및 모니터링 기능**
    - Prometheus/Grafana를 이용하여 배치 작업의 상태 및 로그 모니터링 검증.

3) **Nexus와의 통합 및 애플리케이션 배포**
    - SCDF에서 실행할 배치 및 스트리밍 애플리케이션을 Nexus를 통해 배포 및 관리 가능 여부 검증.

---

## 📌 결론 및 기대 효과

### 🔹 결론
SCDF를 활용하여 **배치와 스트리밍을 통합 관리하는 구조**를 구축할 수 있음을 확인하였으며,
이를 통해 **확장성, 유지보수성, 모니터링 기능을 강화한 배치 시스템 구축**이 가능할 것으로 예상됩니다.

### 🔹 기대 효과
✅ **배치 및 스트리밍 작업을 하나의 플랫폼에서 관리하여 유지보수 용이성 증가**  
✅ **SCDF와 Kafka/RabbitMQ를 활용하여 이벤트 및 메시지 기반 데이터 처리 강화**  
✅ **Prometheus/Grafana를 통한 실시간 모니터링으로 운영 효율성 향상**

PoC를 통해 SCDF의 실용성을 검증한 후, 점진적인 도입 및 고도화 방안을 마련할 예정입니다. 🚀
