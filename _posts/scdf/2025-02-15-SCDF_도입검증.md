---
layout: single
title: SCDF 도입을 위한 과제 선정 및 PoC 진행
categories: SCDF
tag: [SCDF]
toc: true
#author_profile: false
#sidebar:
#    nav: "docs"
---

# 📌 과제 선정 및 PoC 진행

> 팀 블로그용 원고

PoC에서 검증할 과제는 다음과 같습니다.

---

## 🔹 과제 목표

- 리눅스 환경에서 **특정 폴더에 CSV 파일이 생성될 때 자동 감지**
- **SCDF를 통해 해당 파일을 읽고 데이터베이스에 순차적으로 적재**
- **적재된 데이터는 타 시스템과의 동기화 작업에 활용**

---

## 📌 구조 설계

### 🔀 설계 흐름
```
파일 위치 →  파일 감지 → 파일 읽기 → 동기화 시작 → 데이터 적재 → 동기화 종료
```
PoC에서는 위의 흐름을 구현할 수 있도록 **SCDF Stream을 활용하여 설계**하였습니다.

---

## 📌 기능 구현

SCDF의 **Stream과 Task 중 Stream을 활용**하여 PoC를 진행하였습니다.  
(**SCDF에서는 대용량 데이터 처리를 위해 Task 사용을 권장하지만, Stream의 가능성을 검증하기 위해 선택**)

---

### 🔹 a. 파일 감지 및 읽기

#### 📝 프로젝트명
**file-sync-start**

#### ⚡ 파일 변경 감지 방식 검토
- **inotify를 활용하여 파일 변경 시 즉시 감지**
- **일정 주기로 폴더를 검사하는 배치 방식** → 불필요한 리소스 소모로 인해 제외

#### 💡 실패 사례
- SCDF의 `source-file`을 활용하여 파일 감지를 시도했으나, 대용량 데이터 반복 처리가 어려워 실패

#### ⚙️ 최종 구현 방식
- **incron을 활용하여 파일 감지 및 SCDF HTTP Source 트리거 방식으로 구현**

#### 🔀 구현 흐름
```
+---------------------+
|  Watched Directory  |
|  (/home/workday)    |
+---------------------+
          |
          | (File Added)
          v
+----------------------+
|  incron Service     |
|  (incrontab -e 설정)|
+----------------------+
          |
          | (Trigger on file event)
          v
+-------------------------------------+
|  Custom Script                      |
|  (/home/workday/scripts/incron.sh)  |
+-------------------------------------+
          |
          | (HTTP POST Reqeust)
          v
+----------------------+
|  SCDF HTTP Source    |
+----------------------+
```
- 파일이 추가되면 incron이 감지하여 incron.sh 실행
- incron.sh가 SCDF HTTP Source로 파일명을 전달하여 Stream 시작

--- 

### 🔹 b. 읽은 파일 처리 및 데이터 적재

#### 📝 프로젝트명
- file-sync-processor

- SCDF HTTP Source에서 전달받은 파일명을 기반으로 CSV 데이터를 읽어 데이터베이스(MySQL)에 적재

- 데이터 적재 과정에서 파일 검증, 데이터 가공, 매핑 수행

#### 🔀 구현 흐름
```
+----------------------+
|  SCDF HTTP Source   |
+----------------------+
          |
          | (Send File Name)
          v
+----------------------+
|  file-sync-processor |
|----------------------|
|  1. File Validation |
|     - 파일 존재 여부 확인  |
|----------------------|
|  2. File Reader     |
|     - CSV 파일 읽기  |
|----------------------|
|  3. Data Processor  |
|     - 데이터 가공 및 매핑 |
|----------------------|
|  4. Insert into DB  |
|     - MySQL 데이터 적재 |
+----------------------+
          |
          | (DB Insert 완료)
          v
+----------------------+
|  Database (MySQL)   |
+----------------------+
```
- 파일 존재 여부를 검증한 후, CSV 데이터를 읽어 적절한 포맷으로 변환하여 DB에 저장

--- 

### 🔹 c. 동기화 종료 처리
#### 📝 프로젝트명
- file-sync-finish
- file-sync-processor에서 데이터 적재가 완료되면 동기화 상태를 업데이트
#### 🔀 구현 흐름
```
+----------------------+
| file-sync-processor |
+----------------------+
          |
          | (성공여부)
          v
+----------------------+
|  file-sync-finish    |
+----------------------+
          |
          | (update DB)
          v
+----------------------+
|  Database (MySQL)    |
+----------------------+
```
- 성공적으로 적재된 파일에 대한 동기화 상태를 업데이트하여 이후 프로세스와 연계 가능

## 📌 배치 작업 실행 및 모니터링

### 🛠 사용 기술

- Grafana, Prometheus

- SCDF에서 실행되는 Stream의 상태를 모니터링하고 파일 처리 현황을 실시간으로 추적

## 📌 Nexus와의 통합 및 애플리케이션 배포

### 🛠 사용 기술
- Nexus Repository
- SCDF의 Custom Stream Application을 Nexus를 통해 배포 및 관리

## 📌 결론 및 기대 효과

### 🔹 결론
PoC를 통해 SCDF를 활용한 파일 감지 및 데이터 동기화 시스템이 정상적으로 동작함을 검증하였습니다.
이를 통해 파일 기반 데이터 연계 시 SCDF를 효과적으로 활용할 수 있는 아키텍처를 정립할 수 있었습니다.

### 🔹 기대 효과

✅ 파일 기반 데이터 적재 자동화 → 배치 프로세스 최적화  
✅ SCDF를 활용한 확장 가능 구조 설계 → 유지보수 용이성 증가  
✅ SCDF의 Destination 및 Properties 기능을 활용하여 멀티테넌시 구조로 확장 가능

이번 PoC를 통해 SCDF의 가능성을 확인하였으며, 향후 확장성을 고려한 추가 개선 및 기능 보완이 가능합니다. 🚀