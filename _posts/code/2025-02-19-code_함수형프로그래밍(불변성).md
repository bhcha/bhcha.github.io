---
layout: single
title: ğŸ§‘â€ğŸ’»"í•µì‹¬ìš”ê±´ - í•¨ìˆ˜í˜•í”„ë¡œê·¸ë˜ë°(ë¶ˆë³€ì„±)"
categories: code
tag: [í•¨ìˆ˜í˜•, FP, íŒ¨ëŸ¬ë‹¤ì„, java]
toc: true
---

> [ì´ì „ : í•¨ìˆ˜í˜•í”„ë¡œê·¸ë˜ë°(ê³ ì°¨í•¨ìˆ˜)](../code_í•¨ìˆ˜í˜•í”„ë¡œê·¸ë˜ë°(ê³ ì°¨í•¨ìˆ˜))

## ë¶ˆë³€ì„±(Immutability)

í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì—ì„œ **ë¶ˆë³€ì„±** ì€ **ë°ì´í„°(ìƒíƒœ)ë¥¼ í•œ ë²ˆ ë§Œë“¤ì–´ì§€ë©´ ë³€ê²½í•˜ì§€ ì•ŠëŠ” ê²ƒ** ì„ ë§í•œë‹¤.  
ì¦‰, ì–´ë– í•œ ê°’ì´ ë°”ë€Œì–´ì•¼ í•  í•„ìš”ê°€ ìˆì„ ë•Œ, **ê¸°ì¡´ ê°’ì„ ì§ì ‘ ìˆ˜ì •í•˜ëŠ” ëŒ€ì‹ **,  
**ìƒˆë¡œìš´ ê°’ì„ ìƒì„±** í•´ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì„ íƒí•˜ëŠ” ê²ƒì´ë‹¤.

---

### ì™œ ë¶ˆë³€ì„±ì´ ì¤‘ìš”í• ê¹Œ?

1.	**ì˜ˆì¸¡ ê°€ëŠ¥ì„±**  
      -	ê°’ì´ ë°”ë€Œì§€ ì•Šìœ¼ë‹ˆ, ë‹¤ë¥¸ í•¨ìˆ˜ë‚˜ ìŠ¤ë ˆë“œê°€ **ì˜ˆìƒì¹˜ ëª»í•˜ê²Œ ê°’ì„ ë³€ê²½** í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
2.	**ë¶€ì‘ìš© ìµœì†Œí™”**  
      -	ì—¬ëŸ¬ ê³³ì—ì„œ ê³µìœ í•˜ëŠ” ë°ì´í„°ë¥¼ ë°”ê¿€ ì¼ì´ ì—†ìœ¼ë‹ˆ,  
      **â€œë‚´ê°€ ì–¸ì œ, ì–´ë””ì„œ ë³€ê²½ë˜ì—ˆì§€?â€** ë¼ëŠ” ê³ ë¯¼ì´ ì‚¬ë¼ì§„ë‹¤.
3.	**ë™ì‹œì„±(Concurrency)ì— ìœ ë¦¬**  
      -	ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì½ì–´ë„ ë°ì´í„°ë¥¼ ë°”ê¿€ ì¼ì´ ì—†ìœ¼ë‹ˆ, ìŠ¤ë ˆë“œ ì•ˆì „(Thread-Safe).
    
---

### ë¶ˆë³€ ê°ì²´(Immutable Object) ì˜ˆì‹œ

```java
class ImmutableUser {
    private final String name;
    private final int age;

    public ImmutableUser(String name, int age) {
        this.name = name;
        this.age = age;
    }

    // Getter
    public String getName() {
        return name;
    }

    public int getAge() {
        return age;
    }

    // ë‚˜ì´ë¥¼ ë³€ê²½í•´ì•¼ í•œë‹¤ë©´, ìƒˆë¡œìš´ ê°ì²´ë¡œ ë§Œë“¤ì–´ ë°˜í™˜
    public ImmutableUser withAge(int newAge) {
        return new ImmutableUser(this.name, newAge);
    }
}

public class Main {
    public static void main(String[] args) {
        ImmutableUser user1 = new ImmutableUser("Alice", 30);
        ImmutableUser user2 = user1.withAge(31);

        System.out.println("user1 age: " + user1.getAge()); // 30
        System.out.println("user2 age: " + user2.getAge()); // 31
    }
}
```
- user1 ì€ ìƒì„±ë  ë•Œ ì´ë¦„: â€œAliceâ€, ë‚˜ì´: 30.
- withAge(31) ì„ í˜¸ì¶œí•´ë„ ê¸°ì¡´ user1ì€ ê·¸ëŒ€ë¡œ ë‘ê³ , ìƒˆ ê°ì²´ user2 ë¥¼ ë°˜í™˜.
- ë”°ë¼ì„œ ë¶ˆë³€ì„± ì´ ìœ ì§€ë¼, user1 ì˜ ìƒíƒœê°€ ë°”ë€Œì§€ ì•Šì•„.
  ê°ì²´ë¥¼ ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ê¸°

---

í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì—ì„œ â€œë¶ˆë³€ì„±â€ ì„ ì§€í‚¤ë ¤ë©´,
ê¸°ì¡´ ê°ì²´ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ , ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“¤ì–´ ë°˜í™˜ í•´ì•¼ í•œë‹¤.

ê·¸ë ‡ë‹¤ë©´ ìƒˆë¡œìš´ ê°ì²´ëŠ” ì–´ë–»ê²Œ ë§Œë“¤ì–´ì•¼ í• ê¹Œ?
- ì–•ì€ ë³µì‚¬(Shallow Copy) : ê°ì²´ì˜ ì–•ì€ êµ¬ì¡°ë§Œ ë³µì‚¬(ì˜ˆ: 1ì°¨ì› í•„ë“œë§Œ ë³µì‚¬)
- ê¹Šì€ ë³µì‚¬(Deep Copy) : ê°ì²´ê°€ ì°¸ì¡°í•˜ëŠ” í•˜ìœ„ ê°ì²´ ê¹Œì§€ë„ ì „ë¶€ ë³µì‚¬

### ì–•ì€ ë³µì‚¬ ì˜ˆì‹œ
```java
class ImmutablePoint {
    private final int x;
    private final int y;

    public ImmutablePoint(int x, int y) {
        this.x = x;
        this.y = y;
    }

    // x í˜¹ì€ yë¥¼ ë³€ê²½í•  ë•Œ ìƒˆë¡œìš´ ImmutablePoint ìƒì„±
    public ImmutablePoint move(int dx, int dy) {
        // ê¸°ì¡´ x, y ê°’ì„ ì‚¬ìš©í•˜ì—¬ ìƒˆ ê°ì²´ ë°˜í™˜
        return new ImmutablePoint(this.x + dx, this.y + dy);
    }
}
```
- ì—¬ê¸°ì„œëŠ” ë‹¨ìˆœíˆ int í•„ë“œë§Œ ë‹¤ë£¨ë¯€ë¡œ, â€œì–•ì€ ë³µì‚¬â€ ë¼ê³  í•´ë„ í¬ê²Œ ìƒê´€ì€ ì—†ë‹¤.
- ìƒˆë¡œìš´ Point ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì—ì„œ, ê¸°ì¡´ Point ëŠ” ê±´ë“œë¦¬ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ ë‘¬ì•¼ í•œë‹¤.

### ê¹Šì€ ë³µì‚¬ ì˜ˆì‹œ

ë§Œì•½ í•„ë“œê°€ ë˜ ë‹¤ë¥¸ ê°ì²´ë¥¼ ì°¸ì¡°í•˜ê³  ìˆë‹¤ë©´, ê·¸ í•˜ìœ„ ê°ì²´ë„ ë³µì‚¬í•´ì•¼ ì™„ì „í•œ ë¶ˆë³€ì„± ì„ ë³´ì¥í•  ìˆ˜ ìˆë‹¤.

```java
class Address {
    private final String city;
    private final String street;

    // ë¶ˆë³€ì´ë¼ ê°€ì •
    public Address(String city, String street) {
        this.city = city;
        this.street = street;
    }

    // ... getter ë“±ë“±
}

class Person {
    private final String name;
    private final Address address;

    public Person(String name, Address address) {
        this.name = name;
        this.address = address;
    }

    public Person relocate(Address newAddress) {
        // Personë„, Addressë„ ë¶ˆë³€ ê°ì²´ë¼ë©´ "ìƒˆë¡­ê²Œ ìƒì„±"ìœ¼ë¡œ ë¶ˆë³€ì„± ìœ ì§€
        return new Person(this.name, newAddress);
    }
}
```

- Person ì´ Address ê°ì²´ë¥¼ ê°€ì§€ê³  ìˆê³ , Address ë„ ë¶ˆë³€ ê°ì²´ë¼ë©´, ìƒˆë¡œìš´ Address ë¥¼ ë§Œë“¤ ë•Œë§ˆë‹¤ Person ì—­ì‹œ ìƒˆë¡œ ë§Œë“¤ì–´ì•¼ í•¨.

- ë§Œì•½ Address ê°€ ê°€ë³€ì´ë¼ë©´, ê¹Šì€ ë³µì‚¬(Deep Copy) ë¡œ ë‚´ë¶€ í•„ë“œê¹Œì§€ ì „ë¶€ ìƒˆë¡œ ë³µì‚¬í•œ ë’¤, Person ìƒì„±í•´ì•¼ ì§„ì •í•œ ë¶ˆë³€ì„±ì„ ì§€í‚¬ ìˆ˜ ìˆë‹¤.

--- 

### ë¶ˆë³€ì„±ìœ¼ë¡œ ì–»ëŠ” ì¥ì 
1.	ì½”ë“œ ê°€ë…ì„±/ì•ˆì •ì„±
      - â€œì´ ê°’ì´ í˜¹ì‹œ ë°”ë€”ì§€ ëª¨ë¥´ê² ë‹¤â€ ë¼ëŠ” ê±±ì •ì„ ëœì–´ì£¼ë¯€ë¡œ, ì½”ë“œ ì´í•´ê°€ ì‰¬ì›Œì§€ê³  ì‹¤ìˆ˜ ê°€ëŠ¥ì„±ë„ ì¤„ì–´ë“ ë‹¤.
2.	ë””ë²„ê¹…, ìœ ì§€ë³´ìˆ˜ í¸ì˜
      - ìƒíƒœê°€ ë³€ê²½ë˜ì§€ ì•Šìœ¼ë‹ˆ, íŠ¹ì • ì‹œì  ì— ì–´ë–¤ ê°’ì´ì—ˆëŠ”ì§€ ì¶”ì í•˜ê¸° ì‰½ë‹¤.
3.	í…ŒìŠ¤íŠ¸ ìš©ì´
      -	ë™ì¼í•œ ì…ë ¥ì„ ë„£ì—ˆì„ ë•Œ ì–¸ì œë‚˜ ê°™ì€ ê°ì²´(í˜¹ì€ ê°’) ì„ ë°˜í™˜í•˜ë¯€ë¡œ, í…ŒìŠ¤íŠ¸ê°€ ë‹¨ìˆœí•´ì§„ë‹¤.
4.	í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì˜ ë‹¤ë¥¸ íŠ¹ì§•(ì˜ˆ: ìˆœìˆ˜ í•¨ìˆ˜) ê³¼ ì‹œë„ˆì§€
      -	ë¶ˆë³€ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ë©´, í•¨ìˆ˜ê°€ ë‚´ë¶€ ìƒíƒœë¥¼ ë°”ê¾¸ì§€ ì•Šê²Œ ë˜ë¯€ë¡œ, ê³§ ìˆœìˆ˜í•¨ìˆ˜ë¥¼ êµ¬í˜„í•˜ê¸° ì‰¬ì›Œì§„ë‹¤.

---

### ë§ˆë¬´ë¦¬

í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì—ì„œ ë¶ˆë³€ì„±(Immutability) ì€ â€œí•¨ìˆ˜ì²˜ëŸ¼ ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸°â€ ìœ„í•œ í•µì‹¬ì´ë‹¤.
-	ê¸°ì¡´ ê°ì²´ë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³ , ìƒˆë¡œìš´ ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ ë°˜í™˜.
-	ì´ë ‡ê²Œ í•˜ë©´ ë¶€ì‘ìš© ì´ ìµœì†Œí™”ë˜ê³ , ì˜ˆì¸¡ ê°€ëŠ¥ í•œ ì½”ë“œê°€ ë§Œë“¤ì–´ì ¸.

í•¨ìˆ˜ë¥¼ ê°’ì²˜ëŸ¼ ë‹¤ë£¨ê¸° ìœ„í•´ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì„ í•˜ëŠ”ë° í•¨ìˆ˜ ì•ˆì˜ ê°’ì´ ë§ˆìŒëŒ€ë¡œ ë³€ê²½ëœë‹¤ë©´ í•´ë‹¹í•¨ìˆ˜ë¥¼ ê°’ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ê¹Œ?
ë‚´ê°€ ì›í•´ì„œ ë§Œë“  ëœë¤í•¨ìˆ˜ì´ë©´ ìƒê´€ ì—†ê² ì§€ë§Œ ì˜ˆì¸¡ì´ ë¶ˆê°€ëŠ¥í•œ ëœë¤í•¨ìˆ˜ë¼ë©´ í”„ë¡œê·¸ë˜ë°ì„ í•  ìˆ˜ ì—†ì„ê²ƒì´ë‹¤.

> ì–´ë–¤ ì±…ì—ì„œëŠ” ê·¹ë‹¨ì ìœ¼ë¡œ í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ë“¤ë„ ë³µì‚¬í•˜ì—¬ ì›ë³¸ì„ ìœ ì§€í•´ì•¼í•œë‹¤ëŠ” ì£¼ì¥ì„ í•˜ê¸°ë„ í•œë‹¤. 
> ë©”ëª¨ë¦¬ì˜ ë¬¸ì œëŠ” ê°€ë¹„ì§€ ì»¬ë ‰í„°(GC)ì— ìœ„ì„í•´ë²„ë¦¬ëŠ” ê·¹ë‹¨ì ì¸ ë°©ë²•ì´ì—ˆë‹¤.  
> â€œì´ë¡ ì ìœ¼ë¡œ ë¶ˆë³€ì„±ì„ 100% ë³´ì¥í•˜ëŠ” ë°©ì‹ ì¤‘ í•˜ë‚˜â€ë¡œ ë³¼ ìˆ˜ ìˆë‹¤.


ì•ìœ¼ë¡œ ì½”ë“œì—ì„œ ë¶ˆë³€ì„±ì„ ì‹¤ì²œ í•˜ëŠ” ê°€ì¥ ì‰¬ìš´ ë°©ë²•ì€,
â€œê¸°ì¡´ ìƒíƒœë¥¼ ë³€ê²½í•˜ê¸°ë³´ë‹¤ëŠ”, ë³µì‚¬í•œ ê°ì²´ë¥¼ ë°˜í™˜í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì„¤ê³„â€ í•˜ëŠ” ê²ƒì´ë‹¤.
ì´ ê³¼ì •ì—ì„œ ì–•ì€ ë³µì‚¬ ì™€ ê¹Šì€ ë³µì‚¬ ì˜ ê°œë…ë„ í•¨ê»˜ ê³ ë ¤í•´ì•¼ í•œë‹¤ëŠ” ì ì„ ë°˜ë“œì‹œ ê¸°ì–µí•´ì•¼í•œë‹¤.

ë‹¤ìŒ ì‹œê°„ì—” ì´ì–´ì„œ, â€œìˆœìˆ˜ í•¨ìˆ˜(Pure Function)â€ ì— ëŒ€í•´ ì‚´í´ë³¼ ê²ƒì´ë‹¤.
ë¶ˆë³€ì„±ì´ ë’·ë°›ì¹¨ëœë‹¤ë©´, ìˆœìˆ˜ í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ë° í›¨ì”¬ ìˆ˜ì›”í•˜ë‹¤ëŠ” ê±¸ ì•Œ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.


---
### ë²ˆì™¸
ì•„ë˜ëŠ” ì–•ì€ ë³µì‚¬ì™€ ê¹Šì€ ë³µì‚¬ì˜ ëŒ€í‘œì ì¸ ì˜ˆì‹œë¼ê³  ìƒê°í•œë‹¤.
``` java
import java.util.*;

public class ShallowCopyExample {
    /**
     * ì–•ì€ ë³µì‚¬:
     * - Mapì„ ìƒˆë¡œ ë§Œë“¤ë˜, ë‚´ë¶€ì˜ ListëŠ” ê¸°ì¡´ List ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ ì°¸ì¡°í•œë‹¤.
     */
    public static Map<String, List<String>> shallowCopy(Map<String, List<String>> original) {
        // ìƒˆ Map ê°ì²´ ìƒì„±
        Map<String, List<String>> copy = new HashMap<>();

        // ì›ë³¸ mapì˜ key/valueë¥¼ ê·¸ëŒ€ë¡œ ë³µì‚¬ (List ìì²´ëŠ” ì°¸ì¡°ë§Œ ì „ë‹¬)
        for (Map.Entry<String, List<String>> entry : original.entrySet()) {
            copy.put(entry.getKey(), entry.getValue()); 
        }

        return copy;
    }

    public static void main(String[] args) {
        // ì›ë³¸ map
        Map<String, List<String>> originalMap = new HashMap<>();
        originalMap.put("fruits", new ArrayList<>(List.of("apple", "banana")));
        originalMap.put("animals", new ArrayList<>(List.of("cat", "dog")));

        // ì–•ì€ ë³µì‚¬
        Map<String, List<String>> shallowCopiedMap = shallowCopy(originalMap);

        // ì›ë³¸ ë˜ëŠ” ì‚¬ë³¸ ì¤‘ í•˜ë‚˜ë¥¼ ë³€ê²½í•˜ë©´?
        // shallowCopiedMapì˜ "fruits"ëŠ” originalMapì˜ "fruits" List ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ ì°¸ì¡°í•¨
        shallowCopiedMap.get("fruits").add("grape");

        // ê²°ê³¼ í™•ì¸
        System.out.println("ì›ë³¸ Map: " + originalMap.get("fruits"));       // [apple, banana, grape]
        System.out.println("ì–•ì€ ë³µì‚¬ Map: " + shallowCopiedMap.get("fruits")); // [apple, banana, grape]
    }
}
```

> Map ê°ì²´ ìì²´ëŠ” ìƒˆë¡œ ë§Œë“¤ì—ˆì§€ë§Œ, ë‚´ë¶€ì— ì €ì¥ëœ List<String> ê°ì²´ëŠ” ì›ë³¸ê³¼ ë™ì¼í•œ ì£¼ì†Œë¥¼ ì°¸ì¡°í•œë‹¤.  
> ì¦‰, shallowCopiedMap.get("fruits") ë¥¼ ë³€ê²½í•˜ë©´ ì›ë³¸ originalMap.get("fruits") ë„ ë³€ê²½ëœë‹¤.